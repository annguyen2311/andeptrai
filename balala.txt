local LogService = game:GetService("LogService")
local HttpService = game:GetService("HttpService")
local TeleportService = game:GetService("TeleportService")

local webhookURL = "https://discord.com/api/webhooks/1229021039644774530/8s_5Y23i6ZWjGQ_pCQ_rl-JlZ3Kz-oeBHvTRdM44q2tapNSkzOs0ms1AoSLuCClzm7gj"
local foundItems = false

local function sendWebhook(title, description, color)
    local data = {
        ["content"] = nil,
        ["embeds"] = {{
            ["title"] = title,
            ["description"] = description,
            ["color"] = color
        }}
    }
    local success, err = pcall(function()
        HttpService:PostAsync(webhookURL, HttpService:JSONEncode(data), Enum.HttpContentType.ApplicationJson)
    end)
    if not success then
        warn("Failed to send webhook: "..tostring(err))
    end
end

LogService.MessageOut:Connect(function(message, messageType)
    print("MessageType: ", messageType)  -- In ra loại tin nhắn
    print("Message: ", message)          -- In ra nội dung tin nhắn
    if string.find(message, "Found") and string.find(message, "Crystal Key Upper Half") then
        foundItems = true
        local price = string.match(message, "@ (.-)%%") or "Unknown"
        local quantity = string.match(message, "%((%d+)%)") or "Unknown"
        sendWebhook("Sniper Found an Item!", "Item: Crystal Key Upper Half\nPrice: "..price.."%\nQuantity: "..quantity, 5814783)
    end
end)

local function onServerHop()
    if not foundItems then
        sendWebhook("Server Hop", "No items were found on this server. Sniper is switching servers.", 16711680)
    end
    foundItems = false
end

local function hopToNewServer()
    onServerHop()
    local servers = {"ServerID1", "ServerID2", "ServerID3"} -- Thêm danh sách ID server ở đây
    local randomServer = servers[math.random(1, #servers)]
    wait(2)
    TeleportService:TeleportToPlaceInstance(game.PlaceId, randomServer)
end

while true do
    wait(60) -- Đợi 60 giây trước khi chuyển server
    hopToNewServer()
end
